(self.webpackChunkpixlee_photos=self.webpackChunkpixlee_photos||[]).push([[1012],{8268:(module,__unused_webpack_exports,__webpack_require__)=>{var _=__webpack_require__(54821).Z;module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)obj&&"mosaic_v2"===obj.widgetType?__p+='\n\t<li class="photo_block uploader_tile large fade_in" tabindex="0">\n':__p+='\n\t<li class="photo_block uploader_tile" tabindex="0">\n',__p+="\n",hasTOS&&(__p+='\n    <button id="end_uploader_tile_inside">'+__e(I18n.t("widget.upload_now"))+"</button>\n"),__p+="\n\n</li>\n";return __p}},12053:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=12053,e.exports=t},29244:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,n,s,a){e.AppendUploaderTiles=s.Behavior.extend({ui:{uploaderTile:".uploader_tile"},events:{"click @ui.uploaderTile":"clickUploaderTile","keydown @ui.uploaderTile":"clickUploaderTile"},collectionEvents:{sync:"onSync"},clickUploaderTile:function(e){if("keydown"!==e.type||13===e.keyCode){var t={name:"pixlee:show:uploader",type:"action",source:"widget",destination:"parent",data:{widgetId:window.location.href,usingKeyboard:"keydown"===e.type}};window.lastElement=e.target,window.parent.postMessage(JSON.stringify(t),"*")}},onSync:function(e,s){if(!o.isFalsy(s)){var r=this,l=gon.type,d=this.view.options.displayOptions,c=d.headerOptions,u=c.layout,h=c.end_tile_upload_button_background_showHide,p=1,g=!o.isFalsy(t.displayOptions.get("hideIfLessThan"))||!o.isFalsy(gon.current_account.extra_fields.hideIfLessThan),m=a("#frame"),f=a("ul.clearfix"),v=f.children(),w=a(".photo_block:visible"),_=0,y=0,b=0,x={name:"pixlee:widget:num:photos",type:"action",source:"widget",destination:"parent",data:{photoCount:r.view.collection?r.view.collection.length:0}};window.top.postMessage(JSON.stringify(x),"*");var k,O,C=r.view.collection.length;if(g&&(O=o.isFalsy(t.displayOptions.get("hideIfLessThan"))?gon.current_account.extra_fields.hideIfLessThan:t.displayOptions.get("hideIfLessThan")),"carousel"===l)C=r.view.collection.reject((function(e){return e.get("isUploaderTile")})).length;k=void 0!==O?C>=O:C;var S=-1!==o.indexOf(t.currentUser.get("features"),"remove_powered_by"),T=!k&&g,I=!k&&o.isFalsy(h);S||T||I||(x={name:"pixlee:generate:attribution:link",type:"action",source:"widget",destination:"parent",data:{src:window.location.href,locale:window.I18n.locale,isSimple:"standard"===gon.current_album.album_type||"story"===gon.current_album.album_type||"influencer_campaign"===gon.current_album.album_type||"posts"===gon.current_album.album_type,landingPageURL:gon.current_account.extra_fields.landing_page_url,disablePoweredByClick:t.displayOptions.get("disablePoweredByClick")}},window.parent.postMessage(JSON.stringify(x),"*")),g&&!k||!k&&o.isFalsy(h)||a("#header_wrapper").css("visibility","visible"),w.length&&(_=w.width(),y=w.length*_,b=m.width()-y),"vertical"!==l&&"coverflow"!==l&&"horizontal"!==l||b>_&&(p=o.isFalsy(d.num_uploader_tiles)?Math.floor(b/_):d.num_uploader_tiles);var P="tile"===u?v.slice(1):v;if("carousel"!==l&&this.view.collection.length&&P.first().hasClass("uploader_tile")&&a.each(P,(function(e,t){if(!a(t).hasClass("uploader_tile"))return!1;t.remove()})),t.hasTOS&&o.isTruthy(h)&&(s.total>0&&o.isFalsy(s.next)||0===s.total&&1===s.page))if("carousel"===l){var N=new n.Model({isUploaderTile:!0,uploaderTileType:"end"});o.isFalsy(this.view.collection.findWhere(N.attributes))&&(this.view.collection.add(N),this.view.collection.trigger("sync"))}else{this.view.$el.find(".uploader_tile").remove();for(var F=i(8268)({widgetType:l,hasTOS:t.hasTOS}),L=0;L<p;L++)f.append(F);if(this.view.sly)this.view.sly.reload({silentScroll:!0}),a(".next").hasClass("disabled")&&this.view.sly.slideBy(-1,!0)}if(1===s.page&&o.isFalsy(s.next)&&"photowall"!==l&&"mosaic_v2"!==l&&"carousel"!==l&&this.view.onRender(),o.isFalsy(this.view.sly)&&"photowall"!==l&&"mosaic_v2"!==l&&"carousel"!==l){var M=a("#frame"),B={horizontal:0,smart:1,activateMiddle:1,itemNav:d.horizontalLayoutLeftAlign?"basic":"centered",activateOn:"click",mouseDragging:0,touchDragging:1,releaseSwing:1,startAt:0,scrollBy:0,speed:300,elasticBounds:1,easing:"easeOutExpo",prevPage:a(".prev"),nextPage:a(".next")};"coverflow"===l?(B.itemNav="forceCentered",B.horizontal=1,B.easing="swing"):"horizontal"===l&&(B.horizontal=1),this.sly=new Sly(M,B).init()}}}})}))},25145:()=>{Pixlee.module("Behaviors",(function(e,t,i,o,n){e.RefreshOnCssGenerated=o.Behavior.extend({onReloadSly:function(){var e=this;setTimeout((function(){e.view.sly.reload()}),400)}})}))},81370:()=>{Pixlee.module("Behaviors",(function(e,t,i,o,n){e.FilterPhotos=o.Behavior.extend({initialize:function(){var e=this;Cookies.json=!0;var i=t.widget.currentView.collection;i.once("sync",(function(){var t=Cookies.get("pixlee_social_cookie")||Cookies.get("pixlee_social_cookie_legacy");e.initialUrl=i.url(),t&&t.social_login&&t.social_login.social_id&&e.processCollection(t)})),t.commands.setHandlers({"social:login":function(t){e.processCollection(t)},"social:login:loaded":function(){e.socialLoginLoad()}})},ui:{location_alert_overlay:"#location_alert_content",location_alert_allow:"#location_alert_allow",location_alert_deny:"#location_alert_deny",sign_in:"#sign_in",logged_in_container:"#logged_in_container",search_box:"#search_box",loading_social_auth:"#loading_social_auth",dropdown_list:"#dropdown_list",filter_tile:".filter_tile",log_in_container:"#log_in_container",interaction_toggle:"#interaction_toggle",sort_votes:'[data-attr="sortByVotes"]'},events:{"click #sign_in":function(){this.ui.search_box.val(""),this.ui.loading_social_auth.css("visibility","visible");var e={name:"pixlee:show:social:connect",type:"action",source:"widget",destination:"parent",data:{widgetId:window.parentIFrame.getId()}};return window.parent.postMessage(JSON.stringify(e),"*"),!1},"click .filter_tile":function(e){t.commands.execute("filtered:by",n(e.currentTarget).attr("data-attr")),this.selectAllPhotosFilter(),this.showLoader(),this.ui.dropdown_list.hide();var i;t.widget.currentView.collection;return n(e.target).hasClass("active")?(this.ui.filter_tile.removeClass("active"),i=this.initialUrl+"&filterBy=allPhotos"):(this.ui.filter_tile.removeClass("active"),n(e.currentTarget).addClass("active"),i=this.initialUrl+"&filterBy="+n(e.currentTarget).attr("data-attr")),this.fetchCollection(i),!1},"keyup #search_box":function(e){clearTimeout(this.timer);var i=this;this.timer=setTimeout((function(){t.commands.execute("filtered:by","search");var o,s=n(e.currentTarget).val().trim();i.selectAllPhotosFilter(),n("#widget").find(".clearfix").addClass("loading_content_spinner"),o=s.length>0?i.initialUrl+"&filterBy=caption&caption="+s:i.initialUrl,i.fetchCollection(o),i.ui.filter_tile.removeClass("active")}),1e3)},"click #clear_search":function(){return this.ui.search_box.val("").trigger("keyup"),!1},"click .filter_box":function(){return this.ui.search_box.val(""),!1}},onRender:function(){!0!==t.request("get:current:album").get("campaign")&&this.ui.sort_votes.hide()},fetchCollection:function(e){n(".load_more").hide();var i=t.widget.currentView.collection,o=this;i.paginator_core.url=e,i.url=function(){return e},i.goTo(1,{success:function(){o.hideLoader(),n(".load_more").show()},reset:!0})},socialLoginLoad:function(){this.ui.sign_in.show(),this.ui.loading_social_auth.css("visibility","hidden")},editCollectionUrl:function(e){t.widget.currentView.collection;return e.source?this.initialUrl+"&platform="+e.source+"&access_token="+e.access_token+"&access_token_secret="+e.access_token_secret+"&social_id="+e.social_id:this.initialUrl+"&platform=email&email="+e},initCollectionEvents:function(){var e=this,i=t.widget.currentView.collection;e.defaultUrl=i.url(),i.on("sync",(function(){e.hideLoader(),i.length>0?(n("#widget").find(".clearfix").removeClass("no_photos_view"),i.next&&n(".load_more").show(),n(".mosaic_frame").length>0&&n(".mosaic_frame").removeClass("no-pad")):(n("#widget").find(".clearfix").empty(),n(".mosaic_frame").length>0&&n(".mosaic_frame").addClass("no-pad"),n("#widget").find(".clearfix").addClass("no_photos_view"))}))},signOut:function(){this.showLoader(),Cookies.remove("pixlee_social_cookie"),this.ui.log_in_container.show(),this.ui.logged_in_container.hide(),this.hideDropdown(),this.ui.interaction_toggle.off("click");var e="click";"ontouchstart"in window&&(e="touchstart"),this.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").off(e);var t=this.defaultUrl;this.fetchCollection(t),n(".checked").removeClass("checked"),n(".dropdown_list_item").first().addClass("checked")},hideDropdown:function(){this.ui.logged_in_container.find("#dropdown_list").hide()},showLoader:function(){n("#widget").find(".clearfix").removeClass("no_photos_view").addClass("loading_content_spinner")},hideLoader:function(){n("#widget").find(".clearfix").removeClass("loading_content_spinner")},selectAllPhotosFilter:function(){this.ui.interaction_toggle.removeClass().addClass("all_photos"),this.ui.dropdown_list.find(".checked").removeClass("checked"),n('[data-attr="allPhotos"]').addClass("checked")},processCollection:function(e){var i=this;Cookies.set("pixlee_social_cookie",e,{expires:365}),Cookies.set("pixlee_social_cookie_legacy",e,{expires:365}),i.initCollectionEvents();var o=t.widget.currentView.collection;if(!e.social_login)return!1;var s=this.editCollectionUrl(e.social_login);o.paginator_core.url=s,"facebook"!=e.platform&&"email"!=e.platform||n('.dropdown_list_item[data-attr="friendsPhotos"]').remove(),this.ModifiedUrl=s,this.ui.log_in_container.hide(),this.ui.logged_in_container.show(),this.ui.interaction_toggle.on("click",(function(){i.ui.logged_in_container.find("#dropdown_list").toggle();n("body").click((function(e){i.ui.dropdown_list.hide()}))}));var a="click";"ontouchstart"in window&&(a="touchstart"),this.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").on(a,(function(){if(n(this).hasClass("checked"))return!1;if("signOut"==n(this).attr("data-attr"))return i.signOut(),!1;var s,a;if(i.ui.logged_in_container.find("#dropdown_list").find(".dropdown_list_item").removeClass("checked"),n("#desktop_tablet_view").find(".active").removeClass("active"),n(this).addClass("checked"),i.ui.interaction_toggle.attr("class",n(this).attr("data-text")),"nearMe"!=n(this).attr("data-attr")&&(i.currentSelection=n(this).attr("data-text")),"allPhotos"==n(this).attr("data-attr"))s=i.ModifiedUrl+"&filterBy=allPhotos",t.commands.execute("filtered:by","allPhotos"),i.hideDropdown();else if("nearMe"==n(this).attr("data-attr")){i.ui.location_alert_overlay.show();a=this,i.ui.location_alert_allow.click((function(){i.hideDropdown(),i.showLoader(),i.ui.location_alert_overlay.hide(),n(".load_more").hide(),t.commands.execute("filtered:by",n(a).attr("data-attr"),"location"),navigator.geolocation&&(o.reset(),navigator.geolocation.getCurrentPosition((function(e){var t=e.coords.latitude,o=e.coords.longitude;return s=i.ModifiedUrl+"&filterBy="+n(a).attr("data-attr")+"&latitude="+t+"&longitude="+o,i.fetchCollection(s),i.hideDropdown(),!1})))})),i.ui.location_alert_deny.click((function(){return i.showLoader(),i.selectAllPhotosFilter(),s=i.ModifiedUrl+"&filterBy=allPhotos",i.fetchCollection(s),i.ui.location_alert_overlay.hide(),i.hideDropdown(),!1}))}else if("caption"==n(this).attr("data-attr")){t.commands.execute("filtered:by",n(this).attr("data-attr"),"search");s=i.ModifiedUrl+"&filterBy="+n(this).attr("data-attr")+"&caption=hello",i.hideDropdown()}else t.commands.execute("filtered:by",n(this).attr("data-attr"),e.platform),s=i.ModifiedUrl+"&filterBy="+n(this).attr("data-attr"),i.hideDropdown();return n(".mosaic_frame").length>0&&n("#widget").find(".clearfix").empty(),"nearMe"!=n(this).attr("data-attr")?(i.showLoader(),i.fetchCollection(s),!1):void 0}))}})}))},27406:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.HideEmptyAlbumWidget=n.Behavior.extend({initialize:function(){o.isFalsy(t.displayOptions.get("hideIfLessThan"))&&o.isFalsy(gon.current_account.extra_fields.hideIfLessThan)||s("html").css("opacity",0)},collectionEvents:{sync:function(){var e=this,i=setInterval((function(){if("parentIFrame"in window){if(!e.view.collection.length&&o.isFalsy(t.displayOptions.get("is_interactive")))window.parentIFrame.close();else if(o.isFalsy(t.displayOptions.get("hideIfLessThan"))&&o.isFalsy(gon.current_account.extra_fields.hideIfLessThan))if(e.view.collection.length||!o.isFalsy(gon.previewMode)||e.checkedCollection){if(s("#header_wrapper").css("visibility","visible"),-1===o.indexOf(t.currentUser.get("features"),"remove_powered_by")){var n={name:"pixlee:generate:attribution:link",type:"action",source:"widget",destination:"parent",data:{src:window.location.href,isSimple:"standard"===gon.current_album.album_type||"story"===gon.current_album.album_type||"influencer_campaign"===gon.current_album.album_type||"posts"===gon.current_album.album_type,landingPageURL:gon.current_account.extra_fields.landing_page_url,disablePoweredByClick:t.displayOptions.get("disablePoweredByClick")}};window.parent.postMessage(JSON.stringify(n),"*")}}else s(".btn").hide();else{var a=o.isFalsy(t.displayOptions.get("hideIfLessThan"))?gon.current_account.extra_fields.hideIfLessThan:t.displayOptions.get("hideIfLessThan"),r=gon.type,l=e.view.collection.length;if("carousel"===r)l=e.view.collection.reject((function(e){return e.get("isUploaderTile")})).length;l<a&&o.isFalsy(t.displayOptions.get("is_interactive"))?window.parentIFrame.close():(s("html").css("opacity",1),s("#header_wrapper").css("visibility","visible"))}!function(){var t={name:"pixlee:widget:num:photos",type:"action",source:"widget",destination:"parent",data:{photoCount:e.view.collection?e.view.collection.length:0}};window.top.postMessage(JSON.stringify(t),"*")}(),e.checkedCollection=!0,clearInterval(i)}}),32)}}})}))},82377:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Lightbox=n.Behavior.extend({ui:{imgHolder:".img_holder",layerVideo:".layer_video"},events:{"keydown @ui.imgHolder":"openPhotoLightboxDebounced","click @ui.imgHolder":"openPhotoLightboxDebounced","click @ui.layerVideo":"openVideoLightboxDebounced"},initialize:function(){this.openPhotoLightboxDebounced=o.debounce(this.openPhotoLightbox,300,!0),this.openVideoLightboxDebounced=o.debounce(this.openVideoLightbox,300,!0)},onShow:function(){"undefined"!==typeof gon.show_lightbox&&o.isFalsy(gon.show_lightbox)&&(this.ui.imgHolder.addClass("noClick"),this.ui.layerVideo.addClass("noClick"))},openPhotoLightbox:function(e){if("keydown"!==e.type||13===e.keyCode||32===e.keyCode){var i={sortType:gon.sortType,widget:gon.widget,perPage:this.getPageSize()},o={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(this.view.model.collection.toJSONForLightbox()),indexToOpen:this.view.model.collection.indexOf(this.view.model),variables:JSON.stringify(i),current_album:t.request("get:current:album").toJSON(),display_options:t.request("get:display:options").toJSON(),usingKeyboard:"keydown"===e.type}};window.lastElement=this.ui.imgHolder,window.parent.postMessage(JSON.stringify(o),"*")}},openVideoLightbox:function(e){if("keydown"!==e.type||13===e.keyCode||32===e.keyCode){e.preventDefault();var i={sortType:gon.sortType,widget:gon.widget,perPage:this.getPageSize()},o={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(this.view.model.collection.toJSONForLightbox()),indexToOpen:this.view.model.collection.indexOf(this.view.model),variables:JSON.stringify(i),current_album:t.request("get:current:album").toJSON(),display_options:t.request("get:display:options").toJSON(),usingKeyboard:"keydown"===e.type}};window.lastElement=this.ui.imgHolder,window.parent.postMessage(JSON.stringify(o),"*")}},getPageSize:function(){try{return this.view.model.collection.perPage}catch(e){return 0}}})}))},87857:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Reviews=n.Behavior.extend({ui:{imageHolder:".img_holder",accesibilityImage:"img",textReview:".text_review_holder",reviewContent:".text_review",reviewerName:".reviewer_name",starHolder:".star_holder"},onShow:function(){this.reviewOptions=gon.display_options.reviewOptions||{},this.reviewOptions.displayReviews&&(this.markAsReview(),this.updatePhotoReviewInfo())},reviewReducer:function(e,t){return e+t.reviews.length},hasReviews:function(){var e=this.view.model.get("products");if(e.length){var t=o.pluck(e,"reviews_info");return(t[0]?t.reduce(this.reviewReducer,0):0)>0&&!o.isFalsy(this.ui.textReview.data("review-id"))}},isAdjacent:function(e){var t=this.ui.imageHolder.width(),i=s("#widget").width();return Math.floor(i/t)%e===0},convertToReviewTile:function(){var e=this.ui.accesibilityImage.attr("data-prod-image");e=t.request("decode:utf8",e),this.view.$el.addClass("active_review"),this.ui.imageHolder.css("background-image","url("+e+")"),this.ui.accesibilityImage.attr("src",e)},markAsReview:function(){var e=this.view.model.collection,t=e.reviewSelectionOptions,i=this.reviewOptions.frequency||.35,o=e.perPage||15,n=o*i,s=Math.floor(o/n),a=Math.random()/2,r=void 0!==t.lastSet?t.currentModelIndex-t.lastSet:0,l=Math.abs(s-t.gapNoise),d=this.hasReviews(),c=this.isAdjacent(r),u=!r||r>l&&!c,h=("mosaic_v2"===gon.type||"carousel"===gon.type&&"mosaic"===gon.display_options.carouselOptions.layout)&&gon.isMobile&&"small"===this.view.model.get("elementSize");d&&u&&a<=i&&!h?(this.convertToReviewTile(),t.lastSet=t.currentModelIndex,t.gapNoise=Math.ceil(.2*n)):t.gapNoise=0,t.currentModelIndex++},updatePhotoReviewInfo:function(){this.view.model.set("selectedReviewInfo",{id:this.ui.textReview.data("review-id"),title:this.ui.reviewContent.data("title"),content:this.ui.reviewContent.text().trim(),rating:this.ui.starHolder.data("score"),user_name:this.ui.reviewerName.text().trim(),active:this.$el.hasClass("active_review")})}})}))},41469:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Share=n.Behavior.extend({ui:{socialButton:".social_button"},events:{"click @ui.socialButton":"onShare","keydown @ui.socialButton":"onHandleKeyboard"},onHandleKeyboard:function(e){13===e.keyCode&&(e.preventDefault(),e.target.click())},onShare:function(e){var i,n=s(e.currentTarget);n.hasClass("pixlee_fshare")?i="facebook":n.hasClass("pixlee_tweet")?i="twitter":n.hasClass("pixlee_pinit")?i="pinterest":n.hasClass("pixlee_tumblr")&&(i="tumblr"),t.commands.execute("photo:shared",this.view.model.get("album_photo_id"),i);var a={name:"pixlee:social:share",type:"action",source:"widget",destination:"parent",data:{socialNetwork:i,products:o.map(this.view.model.get("products"),(function(e){return{name:t.request("decode:utf8",e.title),sku:e.sku,imageUrl:t.request("decode:utf8",e.image),linkUrl:t.request("decode:utf8",e.link)}}))}};window.parent.postMessage(JSON.stringify(a),"*");var r={name:"pixlee:share:to:social",type:"action",source:"widget",destination:"parent",data:{photoJson:this.view.model.toJSON(),source:i}};window.parent.postMessage(JSON.stringify(r),"*")}})}))},44192:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.ShowPdpCaption=n.Behavior.extend({initialize:function(){this.view.templateHelpers=this.view.templateHelpers||{},Cocktail.mixin(this.view.templateHelpers,this.templateHelpers)},templateHelpers:{isPdpCaption:function(){return!o.isFalsy(t.request("get:display:options").get("pdpCaption"))},getPdpCaption:function(){var e=t.request("get:display:options").get("pdpCaption");return t.request("decode:utf8",e)}}})}))},14033:()=>{Pixlee.module("Behaviors",(function(e,t,i,o,n){e.SocialConnect=o.Behavior.extend({initialize:function(){var e=this,i=t.widget.currentView.collection;e.defaultUrl=i.url(),i.on("sync",(function(t,i){e.getLoginStatus()}))},events:{"click #facebook_login":function(){var e=this;t.execute("facebook:login:photos",(function(t){e.processCollection("facebook",t)}))},"click #instagram_login":function(){var e=this;t.execute("instagram:login:photos",(function(t){e.processCollection("instagram",t)}))},"click #twitter_login":function(){var e=this;t.execute("twitter:login:photos",(function(t){e.processCollection("twitter",t)}))}},processCollection:function(e,i){var o=t.widget.currentView.collection;o.reset(),o.fetch()},getLoginStatus:function(){}})}))},54961:(e,t,i)=>{"use strict";i.r(t);var o=i(27484),n=i.n(o),s=i(54821);const a=i(10285);n().extend(a),Pixlee.module("Behaviors",(function(e,t,i,o,a){e.SubmitContentValidation=o.Behavior.extend({ui:{submitContent:"#submit_content_button",additionalTosInput:".additional_tos_input",tosInput:".tos_input"},onShow:function(){this.ui.submitContent.one("click",this.submitContent.bind(this))},submitContent:function(e){this.view.ui.nameInput.find(".error").hide(),this.view.ui.nameInput.find("input").removeAttr("aria-required"),this.view.ui.emailInput.find(".error").hide(),this.view.ui.emailInput.find(".validate").hide(),this.view.ui.emailInput.find("input").removeAttr("role aria-invalid aria-label"),this.view.ui.dobInput.find(".error").hide();var i=[this.checkDob(),this.checkFullName(),this.checkEmail(),this.checkClientAgreementTos(),this.checkAdditionalFields()];if(s.Z.all(i)){var o=t.displayOptions.get("uploaderMinimumAge"),a=this.view.model.get("dob"),r=!o||!s.Z.isTruthy(a)||n()().diff(n()(a,"MM-DD-YYYY"),"years")>=o;this.ui.submitContent.addClass("disabled"),this.view.trigger("update:breadcrumb","disabled"),r?(this[this.view.options.source+"Submit"](),this.view.triggerMethod("validation:success")):this.view.trigger("show:failed:submission:panel")}else this.ui.submitContent.one("click",this.submitContent.bind(this)),this.focusFirstErrorField()},focusFirstErrorField:function(){this.$el.find(".error:visible, .validate:visible").parent().find("input").first().focus()},checkDob:function(){var e=!0;if(this.view.ui.dobInput.is(":visible")){var t=n()(this.view.ui.dobInputText.val(),"YYYY-MM-DD",!0),i=n()();t.isValid()&&t.isBefore(i)&&t.isAfter("1920-01-01")?this.view.model.set("dob",t.format("MM-DD-YYYY")):(this.view.ui.dobInput.find(".error").show(),e=!1)}return e},checkFullName:function(){var e=!0;return s.Z.isFalsy(this.view.ui.fullNameInputText.val())?(this.view.ui.nameInput.find(".error").show(),this.view.ui.nameInput.find("input").attr("aria-required","true"),e=!1):("facebook"===this.view.options.source&&this.view.model.set("facebook_user_name",this.view.ui.fullNameInputText.val()),this.view.model.set("full_name",this.view.ui.fullNameInputText.val())),e},checkEmail:function(){var e=!0;if(s.Z.isFalsy(this.view.ui.emailInputText.val()))this.view.ui.emailInput.find(".error").show(),this.view.ui.emailInput.find("input").attr("aria-required","true"),e=!1;else{/\S+@\S+\.\S+/.test(this.view.ui.emailInputText.val())?(this.view.ui.emailInput.find(".validate").hide(),this.view.ui.emailInput.find("input").removeAttr("role aria-invalid"),this.view.model.set("email_address",this.view.ui.emailInputText.val())):(this.view.ui.emailInput.find(".validate").show(),this.view.ui.emailInput.find("input").attr({"aria-invalid":"true",role:"alert"}),e=!1)}return e},checkClientAgreementTos:function(){var e=!0;return this.view.ui.clientTosHolder.is(":visible")&&!1!==gon.display_options.clientTosRequired&&(e=this.view.ui.clientTosCheckbox.is(":checked"),this.view.ui.clientTosHolder.find(".error").toggle(!e),e||this.view.ui.clientTosCheckbox.attr("aria-required","true")),e},checkAdditionalFields:function(){var e=!0,t=this.view.model;return e=this.checkAndAddAdditionalTosFields(e,{}).valid,this.view.ui.additionalField.each((function(){var i=a(this),o=i.hasClass("required");s.Z.isFalsy(i.find(".additional_input").val())?o&&(e=!1,i.find(".error").show(),i.find("input").attr("aria-required","true")):(i.find(".error").hide(),i.find("input").removeAttr("aria-required"),t.set(i.find("label").html(),i.find(".additional_input").val()))})),e},instagramSubmit:function(){this.submitPhotos()},facebookSubmit:function(){this.submitPhotos()},googleSubmit:function(){this.submitPhotos()},resolveNameAndEmail:function(){return window._customerProvidedUserProfile&&window._customerProvidedUserProfile.isImmutable?{email:window._customerProvidedUserProfile.email,name:window._customerProvidedUserProfile.name}:{email:this.view.model.get("email_address"),name:this.view.model.get("full_name")}},uploaderAdditionalFields:function(){const e=this.view.connectedUser,i={full_name:e.get("full_name"),email_address:e.get("email_address"),dob:e.get("dob"),uploader_product_input:this.view.model.get("uploader_product_input")||"",tos_accepted_at_utc:n()().unix(),tos_url:t.displayOptions.get("tosLink_text")},o=a(".additional_field");o.length&&o.each((function(){const e=a(this),t=e.find(".error"),o=e.find(".additional_input"),n=e.hasClass("required");if(s.Z.isFalsy(o.val()))n&&t.show();else{t.hide();const n=e.find("label").html();i[n]=o.val()}}));return a(".additional_tos_input").each((function(){const e=a(this),t=e.find("input"),o=t.is(":checked"),n=e.find("label");let s;if(n.length){const e=n.text(),t=window.getComputedStyle?window.getComputedStyle(n[0],":before").content:"none";s="none"!==t&&t?t:e}else s=t.attr("aria-label");i&&(i[s]=o)})),i},desktopSubmit:function(){const e=t.config.toJSON(),i=t.currentUser.toJSON(),o=this.view.collection.models,n=e.distilleryUrl+"api/v2/media/file?api_key="+i.single_access_token+"&time_stamp="+Date.now(),s=this.resolveNameAndEmail(),r=t.request("get:current:album").get("id"),l=[],d=this.uploaderAdditionalFields();for(let c=0;c<o.length;c++){const e=o[c],i=new FormData,u=e.get("files")[0];i.append("file",u);const h={album_id:r,title:e.get("caption")||"",approved:!1,product_skus:e.has("products")?e.get("products").map((function(e){return e.get("sku")})):[],email:s.email,username:s.name,connected_user:this.view.connectedUser.toJSON(),content_type:u.type,uploader:!0,uploader_additional_fields:d};window._customerProvidedUserProfile&&window._customerProvidedUserProfile.vendorId&&(h.vendor_id=window._customerProvidedUserProfile.vendorId),i.append("json",JSON.stringify(h)),e.set("album_id",r);const p=new Promise((function(o,s){a.ajax({type:"POST",url:n,processData:!1,contentType:!1,dataType:"json",success:function(e){t.commands.execute("photo:added",e),o(e)},error:function(t,i,o){"undefined"!==typeof Sentry&&Sentry.captureMessage("Error uploading photo",{tags:{source:"desktop"},contexts:{response:t.responseText,photo:e.toJSON()}})},data:i})}));l.push(p)}Promise.all(l).then((e=>{const t={uploadedAlbumPhotoIds:e.map((e=>e.album_photo_id))};e.length>0&&(t.connected_user_id=e[0].connected_user_id),this.view.trigger("show:confirm:panel",t)})).catch((e=>{t.execute("hide:uploader:loader"),a("#uploader_error").show()}))},checkAndAddAdditionalTosFields:function(e,t){var i=this.view.model;return this.ui.additionalTosInput.each((function(){var o=a(this),n=o.hasClass("required"),s=o.find("input").first(),r=s.is(":checked");n&&!r?(e=!1,o.find(".error").toggle(!r)):n&&r&&(e=!0,o.find(".error").hide());var l,d=o.find("label");if(d.length){var c=d.text(),u=window.getComputedStyle?window.getComputedStyle(d[0],":before").content:"none";l="none"===u?c:u}else l=s.attr("aria-label");i.set(l,r),t.uploader_additional_fields&&(t.uploader_additional_fields[l]=r)})),{extraFields:t,valid:e}},submitPhotos:function(){t.execute("show:uploader:loader"),this.uploadedAlbumPhotoIds=[];var e=this.resolveNameAndEmail(),i=t.request("get:current:album").get("id"),o=t.config.toJSON(),n=t.currentUser.toJSON(),s=this.view.connectedUser.toJSON()||{},r=this.view.collection.models,l=o.distilleryUrl+"api/v2/media?api_key="+n.single_access_token,d=r.map((function(o){var n={album_id:i,title:o.get("caption")||"",email:e.email,username:e.name,photo_uri:o.get("picture")||o.get("baseUrl"),approved:!1,product_skus:o.has("products")?o.get("products").map((function(e){return e.get("sku")})):[],connected_user:s,uploader:!0};return window._customerProvidedUserProfile&&window._customerProvidedUserProfile.vendorId&&(n.vendor_id=window._customerProvidedUserProfile.vendorId),new Promise((function(e,i){a.ajax({type:"POST",url:l,dataType:"json",success:function(i){t.commands.execute("photo:added",i),e(i)},error:function(e,t,i){"undefined"!==typeof Sentry&&Sentry.captureMessage("Error uploading photo",{tags:{source:"social"},contexts:{response:e.responseText,photo:o.toJSON()}})},data:JSON.stringify(n)})}))}));Promise.all(d).then(function(e){this.submitPhotosComplete(e)}.bind(this))},submitPhotosComplete:function(e){t.execute("hide:uploader:loader");var i={uploadedAlbumPhotoIds:e.map((function(e){return e.album_photo_id}))};e.length>0&&(i.connected_user_id=e[0].connected_user_id),this.view.isDestroyed||(this.view.trigger("update:bread:crumb","four"),this.view.trigger("show:confirm:panel",i))}})}))},73204:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.SubmitPhotos=n.Behavior.extend({ui:{submitContent:"#submit_content",dragDropTitle:"#drag_drop_form"},onShow:function(){this.ui.submitContent.one("click",this,this.submitValidation)},submitValidation:function(e){var t=e.data,i=t.$el.find(".required"),n=!0;s.each(i,(function(e,t){var i=s(t).parent();o.isFalsy(t.value)?(n=!1,i.addClass("error")):i.removeClass("error")})),n?(t[t.view.options.source+"Submit"](),t.view.triggerMethod("submit")):t.ui.submitContent.one("click",t,t.submitValidation)},instagramSubmit:function(){var e,i,o=t.request("get:current:album"),n=this.view.collection.models;e=this.createPhotoCollection(n),i=this.createPhotoObj(this.view.connectedUser.toJSON(),e,"instagram",o.get("id")),this.submitPhotos(i,this)},facebookSubmit:function(){var e,i,o=t.request("get:current:album"),n=this.view.collection.models;e=this.createPhotoCollection(n),i=this.createPhotoObj(this.view.connectedUser.toJSON(),e,"facebook",o.get("id")),this.submitPhotos(i,this)},desktopSubmit:function(){for(var e,i=t.config.toJSON(),n=t.currentUser.toJSON(),a=this.view.collection.models,r=i.distilleryUrl+"inbound/v1/create_cp?api_key="+n.single_access_token+"&time_stamp="+Date.now(),l=0;l<a.length;l++){var d=a[l],c=(d.get("uid"),t.request("get:current:album").get("id"));d.set("album_id",c),e={album_id:c,title:o.isFalsy(d.get("caption"))?null:d.get("caption"),email:this.view.model.get("email_address"),username:this.view.model.get("full_name"),connected_user:this.view.connectedUser.toJSON()},s.ajax({type:"POST",url:r,contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:this.successCallback,context:{model:d}})}},successCallback:function(e){var i,n=this.model.get("files"),a=t.request("decode:utf8",n[0].name).replace(/[\`\'\'\(\)\/\+\%]/gi,"_"),r=e.path+a;this.model.set("photoId",e.album_photo_id),n[0].fileKey=r,i=o.isFalsy(this.model.attributes.form)||o.isFalsy(this.model.attributes.form.length)?s("#drag_drop_form"):this.model.attributes.form,window.console&&(console.log("this.model.attributes.form "+this.model.toJSON()),console.log("$(#drag_drop_form).length "+s("#drag_drop_form").length),console.log("form.length "+i.length),console.log('$("#drag_drop_form").find("input[name=key]").length '+i.find("input[name=key]").length)),i.find("input[name=key]").val(r),window.console&&(console.log("key"),console.log(r),console.log(i.find("input[name=key]").val())),i.find("input[name=Filename]").val(a),window.console&&(console.log("Filename"),console.log(a),console.log(i.find("input[name=Filename]").val())),i.find("input[name=policy]").val(e.encoded_policy),window.console&&(console.log("policy"),console.log(e.encoded_policy),console.log(i.find("input[name=policy]").val())),i.find("input[name=signature]").val(e.signature),window.console&&(console.log("signature"),console.log(e.signature),console.log(i.find("input[name=signature]").val())),i.find("input[name=AWSAccessKeyId]").val(e.access_key||"AKIATNG6EAYVBK6T77BU"),window.console&&(console.log("AWSAccessKeyId"),console.log(e.access_key),console.log(i.find("input[name=AWSAccessKeyId]").val())),i.find("input[name=Content-Type]").val(n[0].type),window.console&&(console.log("Content-Type"),console.log(n[0].type),console.log(i.find("input[name=Content-Type]").val())),this.model.attributes.submit()},createPhotoCollection:function(e){for(var i=[],n=0;n<e.length;n++){var s=e[n],a=o.isFalsy(s.get("caption"))?"":s.get("caption");i.push({id:s.get("id"),type:s.get("type"),caption:t.request("encode:utf8",a),extra_data:s.get("extra_data")})}return i},createPhotoObj:function(e,t,i,o){return{connectedUser:JSON.stringify(e),collection:JSON.stringify(t),source:i,album_id:o}},submitPhotos:function(e,i){var n=this;s.ajax({type:"POST",url:"/uploadSocial",contentType:"application/json",dataType:"json",data:JSON.stringify(e),success:function(){var e;147890==t.request("get:current:album").get("id")?(e=t.displayOptions.get("thankYouUrl_input"),o.isFalsy(e)||(e=e+n.view.connectedUser.get("full_name")+"&email="+n.view.connectedUser.get("email_address"),window.top.location=e)):n.view.trigger("show:confirm:panel")}})}})}))},51463:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Tap2ShopMobile=n.Behavior.extend({ui:{customCtaAnchor:".custom_call_to_action_anchor",layerVideo:".layer_video"},events:{"click @ui.customCtaAnchor":"ctaClicked","click @ui.layerVideo":"openVideoLightboxDebounced","keydown @ui.layerVideo":"openVideoLightboxDebounced"},initialize:function(){this.currentAlbum=t.request("get:current:album"),this.displayOptions=t.request("get:display:options"),this.openVideoLightboxDebounced=o.debounce(this.openVideoLightbox,300,!0)},onShow:function(){var e=this.generateCtaLink();if(!o.isFalsy(e)){var i=t.request("decode:utf8",this.formatLink(e,this.view.model));this.ui.customCtaAnchor.attr("href",i),"video"===this.view.model.get("content_type")&&this.ui.layerVideo.attr("href",i)}},ctaClicked:function(){var e=this.generateCtaLink();o.isFalsy(e)||(t.execute("opened:photo",this.view.model.get("album_photo_id"),1,e),t.execute("action:clicked",this.view.model.get("album_photo_id"),e))},generateCtaLink:function(){var e="",t=this.view.model;return"product"!==this.currentAlbum.get("album_type")&&t.get("action_link")?e=t.get("action_link"):t.get("products").length>0?e=t.get("products")[0].link:gon.display_options.customCallToActionLink&&(e=gon.display_options.customCallToActionLink),e},openVideoLightbox:function(e){if("keydown"!==e.type||13===e.keyCode){e.preventDefault();for(var t={sortType:gon.sortType,widget:gon.widget},i=this.view.model.collection.clone(),o=i.length-1;o>=0;o--)"video"!==i.models[o].get("content_type")&&i.models.splice(o,1);var n={name:"pixlee:open:lightbox",type:"action",source:"widget",destination:"lightbox",data:{modelData:JSON.stringify(i.toJSONForLightbox()),indexToOpen:i.indexOf(this.view.model),variables:JSON.stringify(t),current_album:this.currentAlbum.toJSON(),display_options:this.displayOptions.toJSON(),usingKeyboard:"keydown"===e.type}};window.parent.postMessage(JSON.stringify(n),"*")}},formatLink:function(e,t){var i=this.displayOptions;if(o.isFalsy(i.get("url_scheme"))&&o.isFalsy(gon.current_account.extra_fields.url_scheme))return e;try{var n,s=e,a=this.currentAlbum.get("title").replace(/ /g,"-").toLowerCase(),r=encodeURIComponent(encodeURIComponent(a));switch(i.get("url_scheme")?i.get("url_scheme").url_scheme_title:gon.current_account.extra_fields.url_scheme.url_scheme_title){case"kimpton_gacid":n="&gacid="+window.PixleeTags.Kimpton.GACID;break;case"kcp_pixlee":n="&om=pixlee:"+r+":"+this.currentAlbum.id;break;case"kcp_pixlee_v2":n="&pixlee="+r+":"+this.currentAlbum.id;break;default:n=i.get("url_scheme")?i.get("url_scheme").attribution_string:gon.current_account.extra_fields.url_scheme.attribution_string}return-1!==s.indexOf(n)?s:s+n}catch(l){return e}}})}))},6428:()=>{Pixlee.module("Behaviors",(function(e,t,i,o){e.UpdateThumbnailCss=o.Behavior.extend({ui:{imgHolder:".img_holder"},onShow:function(){var e=this.view.model.get("viewport"),t=Pixlee.getViewportBackgroundDimensions(e);this.ui.imgHolder.css({"background-position":t.backgroundPosition,"background-size":t.backgroundSize})}})}))},93098:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.UploadContentValidation=n.Behavior.extend({ui:{nextPanel:"#next",dragDropTitle:"#drag_drop_title"},onShow:function(){this.ui.nextPanel.one("click",this.submitValidation.bind(this))},submitValidation:function(e){var t=this.$el.find(".required"),i=!0,n=!0;s.each(t,(function(e,t){var a=s(t).parent();o.isFalsy(t.value)?(i=!1,a.addClass("error"),s(t).attr("aria-required","true"),n&&(s(t).focus(),n=!1)):a.removeClass("error")})),i?this.view.triggerMethod("show:submit:content:panel"):this.ui.nextPanel.one("click",this.submitValidation.bind(this))}})}))},62490:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Upload=n.Behavior.extend({ui:{uploadNow:"#upload_now"},initialize:function(){gon.previewMode&&window.addEventListener("message",this.receiveDesignEditorMessages,!1)},events:{"click @ui.uploadNow":"openUploader","keydown @ui.uploadNow":"openUploader"},onShow:function(){var e=t.request("get:display:options"),i=e.get("headerOptions");(o.isFalsy(t.request("get:current:album").get("public_contribution"))&&Object.keys(i).length<=1||"undefined"!==typeof e.get("pdpShowUploader")&&o.isFalsy(e.get("pdpShowUploader")))&&this.ui.uploadNow.remove();var n=this.ui.uploadNow.is(":hidden");"tile"===i.layout&&o.isFalsy(i.showViewGallery||i.showDescription||i.showTitle||!n)&&s("#header_tile_container").remove()},openUploader:function(e){if("keydown"!==e.type||13===e.keyCode){var t={name:"pixlee:show:uploader",type:"action",source:"widget",destination:"parent",data:{widgetId:window.location.href,usingKeyboard:"keydown"===e.type}};this.designEditorDevice&&(t.data.designEditorDevice=this.designEditorDevice),window.lastElement=this.ui.uploadNow,window.parent.postMessage(JSON.stringify(t),"*")}},receiveDesignEditorMessages:function(){var e=this;o.throttle((function(t){try{var i=JSON.parse(t.data);"pixlee:design:editor:device"===i.name&&(e.designEditorDevice=i.data.deviceType)}catch(o){return}}),1e3)}})}))},7770:(e,t,i)=>{"use strict";i.r(t);var o=i(27484),n=i.n(o),s=i(54821).Z;const a=i(10285);n().extend(a),Pixlee.module("Behaviors",(function(e,t,i,o,a){e.UploaderValidation=o.Behavior.extend({events:{"click #done":"clickDone"},clickDone:function(){var e=!0,t=this;(this.view.ui.nameInput.find(".error").hide(),this.view.ui.emailInput.find(".error").hide(),this.view.ui.emailInput.find(".validate").hide(),this.view.ui.dobInput.find(".error").hide(),this.view.ui.dobInput.is(":visible"))&&(n()(this.view.ui.dobInputText.val(),"MM-DD-YYYY",!0).isValid()?this.view.model.set("dob",this.view.ui.dobInputText.val()):(this.view.ui.dobInput.find(".error").show(),e=!1));if(s.isFalsy(this.view.ui.fullNameInputText.val())?(this.view.ui.nameInput.find(".error").show(),e=!1):("facebook"===this.view.options.source&&this.view.model.set("facebook_user_name",this.view.ui.fullNameInputText.val()),this.view.model.set("full_name",this.view.ui.fullNameInputText.val())),s.isFalsy(this.view.ui.emailInputText.val()))this.view.ui.emailInput.find(".error").show(),e=!1;else{/\S+@\S+\.\S+/.test(this.view.ui.emailInputText.val())?(this.view.ui.emailInput.find(".validate").hide(),this.view.model.set("email_address",this.view.ui.emailInputText.val())):(this.view.ui.emailInput.find(".validate").show(),e=!1)}this.view.ui.clientTosHolder.is(":visible")&&(this.view.ui.clientTosCheckbox.is(":checked")?this.view.ui.clientTosHolder.find(".error").hide():(e=!1,this.view.ui.clientTosHolder.find(".error").show())),a(".additional_tos_input").length>0&&a(".additional_tos_input").each((function(){a(this).find("input").is(":checked")?a(this).find(".error").hide():(e=!1,a(this).find(".error").show())})),this.view.ui.additionalField.each((function(){var i=a(this).hasClass("required");s.isFalsy(a(this).find(".additional_input").val())?i&&(e=!1,a(this).find(".error").show()):(a(this).find(".error").hide(),t.view.model.set(a(this).find("label").html(),a(this).find(".additional_input").val()))})),e&&this.view.triggerMethod("validation:success")}})}))},31664:(e,t,i)=>{var o=i(54821).Z;Pixlee.module("Behaviors",(function(e,t,i,n,s){e.Vote=n.Behavior.extend({ui:{voteButton:".vote_button",voteCount:".vote_count"},modelEvents:{voted:"onVoted",lightboxVote:"onLightboxVote"},events:{"click @ui.voteButton":"onVoteClicked"},canGetDuh:function(){return void 0!==gon.distinct_user_hash||window.analytics&&window.analytics.getAnonymousId},getDuh:function(){return this.canGetDuh()?gon.distinct_user_hash||window.analytics.getAnonymousId():null},showVoteButtonText:function(e,t){var i="widget."+e;gon.display_options.showVoteCount&&t?this.ui.voteButton.text(I18n.t("widget.vote_count",{label:I18n.t(i),count:t})):this.ui.voteButton.text(I18n.t(i))},onVoteClicked:function(){var e=this.getDuh();e&&(this.voteInterval=this.voteInterval||gon.current_album&&gon.current_album.vote_interval,this.ui.voteButton.hasClass("active")||(this.showVoteButtonText("voted"),this.ui.voteButton.addClass("active")),s.ajax({url:"/social/like",type:"POST",data:{id:this.view.model.get("album_photo_id"),distinct_user_hash:e,fingerprint:gon.fingerprint},dataType:"json",success:function(e){if(e.pixlee_likes){var t={name:"pixlee:save:votes",type:"action",source:"lightbox",destination:"parent",data:{pixlee_likes:e.pixlee_likes}};window.parent.postMessage(JSON.stringify(t),"*")}0===e.error_code?(this.view.model.set({like_count:e.like_count,userVoted:!0}),this.view.model.trigger("voted")):1===e.error_code||(2===e.error_code?(this.ui.voteButton.removeClass("active"),this.showVoteButtonText("vote",this.view.model.get("like_count"))):3===e.error_code&&(this.view.model.set("userVoted",!0),this.view.model.trigger("voted")))}.bind(this)}))},onVoted:function(){this.ui.voteButton.addClass("active"),this.showVoteButtonText("voted",this.view.model.get("like_count")),-1===[void 0,null,"1 day","7 days","1 year"].indexOf(this.voteInterval)&&(this.view.model.set("userVoted",!1),this.ui.voteButton.removeClass("active"),this.showVoteButtonText("vote",this.view.model.get("like_count")))},onLightboxVote:function(){this.ui.voteButton.addClass("active"),this.onVoteClicked()},onShow:function(){this.canGetDuh()||this.ui.voteButton.hide()}}),e.CollectionVote=n.Behavior.extend({collectionEvents:{sync:function(){this.firstLoad=!0,this.onSync(this)}},initialize:function(){var e=this;this.view.options.collectionQueue&&this.view.options.collectionQueue.on("sync",function(){this.firstLoad=!0,this.onSync(this)}.bind(this)),t.commands.setHandlers({"vote:loaded":o.bind(this.onSync,this)}),window.addEventListener("message",(function(t){var i;if(t.data){try{i=JSON.parse(t.data)}catch(l){return}if(i.name&&"pixlee:lightbox:vote"===i.name){var n=JSON.parse(i.data),a=!1;if(o.each(e.view.collection.models,(function(e){var t=e.get("album_id")+"_"+e.get("album_photo_id")===n.album_id+"_"+n.album_photo_id;t&&(e.trigger("lightboxVote"),e.set("userVoted",!0)),a=a||t})),!a){var r=gon.distinct_user_hash||window.analytics.getAnonymousId();if(!r)return;s.ajax({url:"/social/like",type:"POST",data:{id:n.album_photo_id,distinct_user_hash:r,fingerprint:gon.fingerprint},dataType:"json"})}}}}),!1)},onSync:function(e){if(gon.pixlee_votes&&gon.pixlee_votes.length>0&&this.firstLoad){var t={name:"pixlee:save:votes",type:"action",source:"lightbox",destination:"parent",data:{pixlee_likes:gon.pixlee_votes}};window.parent.postMessage(JSON.stringify(t),"*");var i=this.view.collectionQueue?this.view.collectionQueue.models:this.view.collection.models;o.each(i,(function(e){-1!=o.indexOf(gon.pixlee_votes,e.get("album_id")+"_"+e.get("album_photo_id"))&&(e.trigger("voted"),e.set("userVoted",!0))}))}}})}))},63172:(e,t,i)=>{var o={"./append_uploader_tiles.js":29244,"./css_generator_refresh.js":25145,"./filter_photos.js":81370,"./hide_empty_album_widget.js":27406,"./photo_item_lightbox.js":82377,"./reviews.js":87857,"./share.js":41469,"./show_pdp_caption.js":44192,"./social_connect.js":14033,"./submit_content_validation.js":54961,"./submit_photos.js":73204,"./tap2shop_actionlinks.js":51463,"./update_thumbnail_css.js":6428,"./upload_content_validation.js":93098,"./uploader_button.js":62490,"./uploader_validation.js":7770,"./vote.js":31664};function n(e){var t=s(e);return i(t)}function s(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}n.keys=function(){return Object.keys(o)},n.resolve=s,e.exports=n,n.id=63172},61658:(e,t,i)=>{"use strict";var o=i(22692),n=i(26978),s=i(4002),a=i(54821).Z,r=function(e,t){var i=new t.Application;i.version="v4",i.isMobile=gon.isMobile||!1,i.isTablet=gon.isTablet||!1,i.isDesktop=!gon.isMobile&&!gon.isTablet;var o=!(!gon.display_options.tosLabel_text||!gon.display_options.tosLabel_text.trim()),r=!(!gon.display_options.tosLink_text||!gon.display_options.tosLink_text.trim());i.hasTOS=o&&r;var l={name:"pixlee:widget:size:fix",type:"action",source:"widget",destination:"parent",data:{widgetType:gon.type,widgetId:gon.publication_id}};"show_widget"===gon.action&&window.parent.postMessage(JSON.stringify(l),"*");var d={name:"pixlee:experiment:info",type:"action",source:"widget",destination:"parent",data:{experimenting:gon.experimenting}};if(d.data.experimenting&&(d.data.experiment_id=gon.experiment_id,d.data.experiment_group=gon.experiment_group),window.parent.postMessage(JSON.stringify(d),"*"),gon.experimenting&&gon.experiment_group&&"no_widget"===gon.experiment_group){window.parent.postMessage(JSON.stringify({name:"pixlee:hide:widget",type:"action",source:"widget",destination:"parent",data:{}}),"*")}var c=gon.current_album&&gon.current_album.campaign?50:1,u=0;return i.on("before:start",(function(e){if(i.isWidget=!0,i.config=i.request("set:config:photos:app"),i.currentUser=i.request("set:current:user",e.current_account),i.currentAlbum=i.request("set:current:album",e.current_album),i.displayOptions=new i.Entities.DisplayOptions(e.display_options),i.recipe=i.request("set:recipe",e.recipe),s.extend(!0,I18n.translations[I18n.locale],gon.custom_text),a.isFalsy(i.currentAlbum.get("description"))?a.isFalsy(i.currentAlbum.get("title"))?i.altText="This is a photo gallery":i.altText="This is a photo gallery with the title of: "+(0,n.decodeUtf8)(i.currentAlbum.get("title")):i.altText="This is a photo gallery with the title of: "+(0,n.decodeUtf8)(i.currentAlbum.get("description")),gon.previewMode)window.addEventListener("message",(function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(o){return}t.name&&"pixlee:css:generated"===t.name&&s.ajax({url:"/generatecss",type:"POST",data:t.data,dataType:"json",success:function(e){s("#proserveStylesheet").html(e.proserve_css),s("#dynamicStylesheet").html(e.css),i.execute("stylesheet:generated",e.css,e.params,e.display_options),i.displayOptions.set("standaloneOptions.bannerImage_showHide",t.data.displayOptions.standaloneOptions.bannerImage_showHide),i.displayOptions.set("standaloneOptions.logoImage_showHide",t.data.displayOptions.standaloneOptions.logoImage_showHide),i.displayOptions.set("standaloneOptions.logoImage_input",t.data.displayOptions.standaloneOptions.logoImage_input),i.displayOptions.set("standaloneOptions.bannerImage_input",t.data.displayOptions.standaloneOptions.bannerImage_input),i.displayOptions.set("standaloneOptions.logoImage_backgroundImage",t.data.displayOptions.standaloneOptions.logoImage_backgroundImage),i.displayOptions.set("standaloneOptions.bannerImage_backgroundImage",t.data.displayOptions.standaloneOptions.bannerImage_backgroundImage),i.displayOptions.set("headerOptions.end_tile_upload_button_background_showHide",t.data.displayOptions.headerOptions.end_tile_upload_button_background_showHide),i.displayOptions.set("reviewOptions.lightboxReviews",t.data.displayOptions.reviewOptions.lightboxReviews),i.displayOptions.set("reviewOptions.frequency",t.data.displayOptions.reviewOptions.frequency),i.displayOptions.set("carouselOptions.smoothSwiping",t.data.displayOptions.carouselOptions.smoothSwiping),i.displayOptions.set("pageSize",t.data.displayOptions.pageSize)}})}}),!1);else{window.addEventListener("message",(function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(n){return}if(t&&t.name&&"pixlee:hide:lightbox"===t.name){if(i.displayOptions.get("disableFocusAfterCloseLightbox"))return;a.isTruthy(window.lastElement)&&window.lastElement.focus()}if(t&&t.name&&"pixlee:close:uploader"===t.name){if(i.displayOptions.get("disableFocusAfterCloseLightbox"))return;a.isTruthy(window.lastElement)&&window.lastElement.focus()}var o;if(t&&t.name&&"pixlee:social:login"===t.name&&i.execute("social:login",t.data),t&&t.name&&"pixlee:social:login:loaded"===t.name&&i.execute("social:login:loaded"),t&&t.name&&"pixlee:widget:visible"===t.name&&t.data.src===window.location.href&&setTimeout((function(){i.execute("widget:visible")}),500),t&&t.function&&"kpiEvent"===t.function)t.data&&t.data.event&&(o=t.data.event),i.execute("kpi:event",o);t.name&&"pixlee:fingerprint"===t.name&&(gon.fingerprint=t.data)}}),!1)}i.publication_id=e.widget_id})),function e(){if(u<c)u+=1,setTimeout((function(){a.isFalsy(gon.distinct_user_hash)?("undefined"!==typeof analytics&&analytics.getAnonymousId&&(gon.distinct_user_hash=analytics.getAnonymousId()),e()):s.ajax({url:"/initializeCookie",type:"POST",data:{distinct_user_hash:gon.distinct_user_hash},dataType:"json",success:function(e){gon.pixlee_votes=e.votes,i.execute("vote:loaded");var t={name:"pixlee:vote:loaded",type:"relay",source:"widget",destination:"lightbox",data:{pixlee_votes:e.votes}};window.top.postMessage(JSON.stringify(t),"*")}})}),100);else;}(),i.reqres.setHandler("get:current:album",(function(){return i.currentAlbum})),i.reqres.setHandler("get:display:options",(function(){return i.displayOptions})),i.reqres.setHandler("get:recipe",(function(){return i.recipe})),i.reqres.setHandler("get:photo:url",(function(e){return Routes.distillery_photo_path(e)})),i.reqres.setHandler("get:location:url",(function(){return Routes.distillery_analytics_location_path()})),i.addRegions({widget:"#widget"}),i.reqres.setHandler("default:region",(function(){return i.widget})),i.commands.setHandler("register:instance",(function(e,t){if("development"===i.config.environment)return i.register(e,t)})),i.reqres.setHandler("concern",(function(e){return i.Concerns[e]})),i.commands.setHandler("unregister:instance",(function(e,t){if("development"===i.config.environment)return i.unregister(e,t)})),i.commands.setHandlers({"show:uploader:loader":function(){s("#uploader_loader").show()},"hide:uploader:loader":function(){s("#uploader_loader").hide()},"nav:right":function(e,t){window.parent.postMessage(JSON.stringify({name:"pixlee:widget:navigated",type:"action",source:"widget",destination:"parent",data:{}}),"*"),i.commands.execute("nav:right:event",e,t)}}),i}(o.yE,o.uB);window.Pixlee=r},54196:()=>{!function(){"use strict";var e=!0,t=10,i="",o=0,n="",s="",a=!1,r={resize:1,click:1},l=128,d=1,c=!0,u="offset",h=u,p=!0,g="",m=32,f=!1,v="[iFrameSizer]",w=v.length,_="",y=!1,b={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},x="*",k=window.parent,O=0,C=!1,S=null,T=1;function I(e,t,i){"addEventListener"in window?e.addEventListener(t,i,!1):"attachEvent"in window&&e.attachEvent("on"+t,i)}function P(e){return v+"["+_+"] "+e}function N(e){f&&"object"===typeof window.console&&console.log(P(e))}function F(e){"object"===typeof window.console&&console.warn(P(e))}function L(){var t;N("Initialising iFrame"),function(){var t=g.substr(w).split(":");function r(e){return"true"===e}_=t[0],o=void 0!==t[1]?Number(t[1]):o,a=void 0!==t[2]?r(t[2]):a,f=void 0!==t[3]?r(t[3]):f,m=void 0!==t[4]?Number(t[4]):m,y=void 0!==t[5]?r(t[5]):y,e=void 0!==t[6]?r(t[6]):e,n=t[7],h=void 0!==t[8]?t[8]:h,i=t[9],s=t[10],O=void 0!==t[11]?Number(t[11]):O}(),function(){void 0===n&&(n=o+"px");(function(e,t){-1!==t.indexOf("-")&&(F("Negative CSS value ignored for "+e),t="")})("margin",n),M("margin",n)}(),M("background",i),M("padding",s),(t=document.createElement("div")).style.clear="both",t.style.display="block",document.body.appendChild(t),B(),document.documentElement.style.height="",document.body.style.height="",N('HTML & body height set to "auto"'),y&&(N("Enable public methods"),window.parentIFrame={close:function(){z("close","parentIFrame.close()",0,0)},getId:function(){return _},reset:function(){Y("parentIFrame.size")},scrollTo:function(e,t){K(t,e,"scrollTo")},scrollToOffset:function(e,t){K(t,e,"scrollToOffset")},sendMessage:function(e,t){K(0,0,"message",JSON.stringify(e),t)},setHeightCalculationMethod:function(e){h=e,B()},setTargetOrigin:function(e){N("Set targetOrigin: "+e),x=e},size:function(e,t){var i=(e||"")+(t?","+t:"");R(),z("size","parentIFrame.size("+i+")",e,t)}}),!0===e?(I(window,"resize",(function(){z("resize","Window resized")})),I(window,"click",(function(){z("click","Window clicked")})),function(){var e=window.MutationObserver||window.WebKitMutationObserver;function t(){var t=document.querySelector("body"),i={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},o=new e((function(e){z("mutationObserver","mutationObserver: "+e[0].target+" "+e[0].type),function(e){function t(e){void 0!==e.height&&void 0!==e.width&&0!==e.height&&0!==e.width||(N("Attach listerner to "+e.src),I(e,"load",(function(){z("imageLoad","Image loaded")})))}e.forEach((function(e){if("attributes"===e.type&&"src"===e.attributeName)t(e.target);else if("childList"===e.type){var i=e.target.querySelectorAll("img");Array.prototype.forEach.call(i,(function(e){t(e)}))}}))}(e)}));N("Enable MutationObserver"),o.observe(t,i)}e?0>m?U():t():(F("MutationObserver not supported in this browser!"),U())}()):N("Auto Resize disabled"),z("init","Init message from host page")}function M(e,t){void 0!==t&&""!==t&&"null"!==t&&(document.body.style[e]=t,N("Body "+e+' set to "'+t+'"'))}function B(){u!==h&&(h in j||(F(h+" is not a valid option for heightCalculationMethod."),h="bodyScroll"),N('Height calculation method set to "'+h+'"'))}function U(){0!==m&&(N("setInterval: "+m+"ms"),setInterval((function(){z("interval","setInterval: "+m)}),Math.abs(m)))}function A(){function e(e){var i=document.body,o=0;return o="defaultView"in document&&"getComputedStyle"in document.defaultView?null!==(o=document.defaultView.getComputedStyle(i,null))?o[e]:0:function(e){if(/^\d+(px)?$/i.test(e))return parseInt(e,t);var o=i.style.left,n=i.runtimeStyle.left;return i.runtimeStyle.left=i.currentStyle.left,i.style.left=e||0,e=i.style.pixelLeft,i.style.left=o,i.runtimeStyle.left=n,e}(i.currentStyle[e]),parseInt(o,t)}return document.body.offsetHeight+e("marginTop")+e("marginBottom")}function D(){return document.body.scrollHeight}function V(){return document.documentElement.offsetHeight}function J(){return document.documentElement.scrollHeight}function E(){return[A(),D(),V(),J()]}function q(){return Math.max.apply(null,E())}var j={offset:A,bodyOffset:A,bodyScroll:D,documentElementOffset:V,scroll:J,documentElementScroll:J,max:q,min:function(){return Math.min.apply(null,E())},grow:q,lowestElement:function(){return Math.max(A(),function(){for(var e=document.querySelectorAll("body *"),t=e.length,i=0,o=(new Date).getTime(),n=0;n<t;n++)e[n].getBoundingClientRect().bottom>i&&(i=e[n].getBoundingClientRect().bottom);return o=(new Date).getTime()-o,N("Parsed "+t+" HTML elements"),N("LowestElement bottom position calculated in "+o+"ms"),i}())}};function H(){return Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)}function z(e,t,i,o){var n,s;function l(){e in{reset:1,resetPage:1,init:1}||N("Trigger event: "+t)}C&&e in r?N("Trigger event cancelled: "+e):!function(){function e(e,t){return!(Math.abs(e-t)<=O)}return n=void 0!==i?i:j[h](),s=void 0!==o?o:H(),e(d,n)||a&&e(T,s)}()?!(e in{init:1,interval:1,size:1})&&h in b?Y(t):e in{interval:1}||(l(),N("No change in size detected")):(l(),R(),K(d=n,T=s,e))}function R(){C||(C=!0,N("Trigger event lock on")),clearTimeout(S),S=setTimeout((function(){C=!1,N("Trigger event lock off"),N("--")}),l)}function Z(e){d=j[h](),T=H(),K(d,T,e)}function Y(e){var t=h;h=u,N("Reset trigger event: "+e),R(),Z("reset"),h=t}function K(e,t,i,o,n){var s;void 0===n?n=x:N("Message targetOrigin: "+n),N("Sending message to host page ("+(s=_+":"+e+":"+t+":"+i+(void 0!==o?":"+o:""))+")"),k.postMessage(v+s,n)}I(window,"message",(function(e){v===(""+e.data).substr(0,w)&&(c&&e.data.split(":")[2]in{true:1,false:1}?(g=e.data,k=e.source,L(),c=!1,setTimeout((function(){p=!1}),l)):"reset"===e.data.split("]")[1]?p?N("Page reset ignored by init"):(N("Page size reset by host page"),Z("resetPage")):e.data===g||"iFrameResize"in window||F("Unexpected message ("+e.data+")"))}))}()}}]);
//# sourceMappingURL=1012-a6a6c06af36c94920b16.js.map